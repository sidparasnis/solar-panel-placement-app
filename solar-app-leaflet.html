<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title>Display a map</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
  integrity="sha512-Rksm5RenBEKSKFjgI3a41vrjkw4EVPlJ3+OiI65vTjIdo9brlAacEuKOiQ5OFh7cOI1bkDwLqdLw3Zg0cRJAAQ=="
  crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"
 integrity="sha512-/Nsx9X4HebavoBvEBuyp3I7od5tA0UzAxs+j83KgC8PU0kgB4XiK4Lfe4y4cgBtaRJQEIFCW+oC506aPT2L1zw=="
 crossorigin=""></script>
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.css"/>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.2/leaflet.draw.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <script src='https://npmcdn.com/@turf/turf/turf.min.js'></script>

    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>
    <style>
    #fit {
        display: block;
        position: relative;
        margin: 0px auto;
        width: 50%;
        height: 59px;
        padding: 10px;
        border: none;
        border-radius: 3px;
        font-size: 12px;
        text-align: center;
        color: #fff;
        background: #ee8a65;
    }
</style>
</head>
<body>
    <div class="row" style="height:600px;">
      <div id='map' style="height:600px;"></div>
    </div>
    <div class="row" style="height:200px;">
      <input type="text" class="form-control" id="param" style="height:80px;width:200px;">
      <span class="input-group-btn" >
        <button class="btn btn-default" type="button" onClick="httpGetAsync(document.getElementById('param').value, moveMap);">Go!</button>
      </span>
    </div>


<script>
var map = L.map('map', {drawControl: true}).setView([51.505, -0.09], 17);

L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);



map.on('draw:created', function (e) {
    // Do whatever else you need to. (save to db, add to map etc)
    map.addLayer(e.layer);
    console.log(e.layer.toGeoJSON().geometry.coordinates);
    var polygon = turf.polygon(e.layer.toGeoJSON().geometry.coordinates);
    console.log(turf.area(polygon));

});

function moveMap(res) {
  //console.log(term)
  var resJSON = JSON.parse(res);
  console.log(resJSON);
  var lat = resJSON.results[0].geometry.location.lat;
  var lng = resJSON.results[0].geometry.location.lng;
  console.log(lat, lng);
  map.panTo(new L.LatLng(lat, lng));
};

function httpGetAsync(term, cb)
{
    var theUrl = "https://maps.googleapis.com/maps/api/geocode/json?address=" + term + "&key=AIzaSyB_L9c5d5kZyo3B1OQ-e020RYGaGSQWNRY"
    console.log(theUrl);
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.onreadystatechange = function() {
        if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
            cb(xmlHttp.responseText);
    }
    xmlHttp.open("GET", theUrl, true); // true for asynchronous
    xmlHttp.send(null);
}
</script>

</body>
</html>
